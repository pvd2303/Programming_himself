/*! @build 3.0.b1b811e-2.1.0 gsc cc5fb9173737a8b44854 */!function(t){function e(e){for(var n,s,r=e[0],o=e[1],a=0,u=[];a<r.length;a++)s=r[a],i[s]&&u.push(i[s][0]),i[s]=0;for(n in o)({}).hasOwnProperty.call(o,n)&&(t[n]=o[n]);for(c&&c(e);u.length;)u.shift()()}var n={},i={0:0};function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise(function(e,s){n=i[t]=[e,s]});e.push(n[2]=r);var o,a=document.createElement("script");a.type="module",a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(t){return s.p+""+({1:"widgets"}[t]||t)+"."+{1:"872d65c7277a62d9af4a"}[t]+".js"}(t);var c=new Error;o=function(e){a.onerror=a.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",c.name="ChunkLoadError",c.type=s,c.request=r,n[1](c)}i[t]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:a})},12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(e)},s.m=t,s.c=n,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return{}.hasOwnProperty.call(t,e)},s.p="https://s2.getsitecontrol.com/widgets/es6/",s.oe=function(t){throw t};var r=window.webpackJsonp_gsc=window.webpackJsonp_gsc||[],o=r.push.bind(r);r.push=e,r=r.slice();for(var a=0;a<r.length;a++)e(r[a]);var c=o;s(s.s="oqNQ")}({"8drd":function(t,e,n){n.d(e,"d",function(){return s}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a});const i=window,s=function(t){},r=()=>i.JSON,o=t=>i.btoa(t),a=t=>i.encodeURIComponent(t)},BRWp:function(t,e,n){n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r}),n.d(e,"c",function(){return o});var i,s=n("Mbz3");!function(t){t.User="user",t.Session="session",t.PageView="pageView",t.Show="show",t.Close="close",t.Hide="hide",t.SubmitWidget="submit",t.OpenUrl="openUrl",t.ShowWidget="showWidget"}(i||(i={}));class r{constructor(t,e,n){this.type=t,this.widget=e,this.data=n}prettyData(){const t=this.data||{};return this.type===i.OpenUrl?t.url:this.type===i.ShowWidget?t.widgetId:t}isAction(){return this.type===i.SubmitWidget||this.type===i.ShowWidget||this.type===i.OpenUrl}}class o{constructor(t,e=[]){this.runtime=t,this.subscribers=e,this.events=[]}send(t){this.add(t,!0)}add(t,e=!1){if(this.events.push(t),e)return this.process();Object(s.a)(this.process.bind(this),100)()}process(){const t=this.events.slice();if(this.events.length=0,t.length>0){const n=this.collectContext();for(const i of this.subscribers)try{i(t,n)}catch(e){}}}collectContext(){const t=this.runtime.session.currentVisit,e=new Date;return{userId:t.userId,sessionId:t.sessionId,siteId:this.runtime.settings.siteId,date:e.getTime(),visit:{utm:{medium:t.utm.utm_medium,source:t.utm.utm_source,term:t.utm.utm_term,content:t.utm.utm_content,campaign:t.utm.utm_campaign},source:t.source,referrer:t.referrer,pageNumber:t.pageNumber,sessionNumber:t.sessionNumber,location:t.location,language:t.language,displayWidth:t.displayWidth,displayHeight:t.displayHeight},context:this.runtime.args.getParams(!0),placement:this.runtime.settings.placement}}}},Him1:function(t,e,n){function i(t,e={},n=function(t){return t.replace(/[&<>"'`]/g,t=>s[t])},i=!1){return t&&e&&/{{.+}}/.test(t)?t.replace(/{{ *(\$?\w+?) *(\|[^}]*)?}}/gi,(t,s,r)=>{let o=e[s];if(null==o)if(r)o=r.substr(1).trim(),n=t=>t;else{if(!i)return t;o=""}return n(`${o}`)}):t}n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r}),n("8drd").c;const s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}},Mbz3:function(t,e,n){function i(t){let e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments)),e}}function s(t,e){let n;return function(){const i=this,s=arguments;clearTimeout(n),n=setTimeout(function(){n=null,t.apply(i,s)},e)}}function r(t,e){const n={};return function(...i){let s=e(i);return n[s]?n[s]:n[s]=t.apply(null,i)}}n.d(e,"c",function(){return i}),n.d(e,"a",function(){return s}),n.d(e,"b",function(){return r})},SKuX:function(t,e,n){function i(t,e){return Object.keys(t).reduce((n,i)=>(n[i]=e(t[i]),n),{})}function s(t){return t}function r(t){return t.hasOwnProperty("flat")?t.flat(1):[].concat(...t)}function o(t){const e=t.slice();for(let n=e.length-1;n>0;n--){const t=Math.floor(Math.random()*(n+1));[e[n],e[t]]=[e[t],e[n]]}return e}n.d(e,"b",function(){return i}),n.d(e,"d",function(){return s}),n.d(e,"a",function(){return r}),n.d(e,"c",function(){return o})},Yqmp:function(t,e,n){n.d(e,"a",function(){return i});class i{constructor(){this.handlers={}}on(t,e){return this.handlers[t]?this.handlers[t].push(e):this.handlers[t]=[e],this}off(t,e){if(this.handlers[t])if(e)for(let n=0;n<this.handlers[t].length;n++)this.handlers[t][n]===e&&this.handlers[t].splice(n,1);else delete this.handlers[t];return this}one(t,e){const n=(...i)=>(e.apply(this,i),this.off(t,n));return this.on(t,n)}trigger(t,...e){const n={result:!0,stop:!1};if(this.handlers[t])for(const i of this.handlers[t])n.stop||(n.out=i.apply(this,[n].concat(e)),n.result=n.result&&(void 0===n.out||!!n.out));return n}proxy(t,e,n=t){e.on(t,(t,...e)=>this.trigger(n,...e))}}},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},jYEY:function(t,e,n){var i;!function(s){function r(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t,e,n,i,s,o){return r((a=r(r(e,t),r(i,o)))<<(c=s)|a>>>32-c,n);var a,c}function a(t,e,n,i,s,r,a){return o(e&n|~e&i,t,e,s,r,a)}function c(t,e,n,i,s,r,a){return o(e&i|n&~i,t,e,s,r,a)}function u(t,e,n,i,s,r,a){return o(e^n^i,t,e,s,r,a)}function h(t,e,n,i,s,r,a){return o(n^(e|~i),t,e,s,r,a)}function l(t,e){var n,i,s,o,l;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var d=1732584193,g=-271733879,f=-1732584194,m=271733878;for(n=0;n<t.length;n+=16)i=d,s=g,o=f,l=m,d=a(d,g,f,m,t[n],7,-680876936),m=a(m,d,g,f,t[n+1],12,-389564586),f=a(f,m,d,g,t[n+2],17,606105819),g=a(g,f,m,d,t[n+3],22,-1044525330),d=a(d,g,f,m,t[n+4],7,-176418897),m=a(m,d,g,f,t[n+5],12,1200080426),f=a(f,m,d,g,t[n+6],17,-1473231341),g=a(g,f,m,d,t[n+7],22,-45705983),d=a(d,g,f,m,t[n+8],7,1770035416),m=a(m,d,g,f,t[n+9],12,-1958414417),f=a(f,m,d,g,t[n+10],17,-42063),g=a(g,f,m,d,t[n+11],22,-1990404162),d=a(d,g,f,m,t[n+12],7,1804603682),m=a(m,d,g,f,t[n+13],12,-40341101),f=a(f,m,d,g,t[n+14],17,-1502002290),d=c(d,g=a(g,f,m,d,t[n+15],22,1236535329),f,m,t[n+1],5,-165796510),m=c(m,d,g,f,t[n+6],9,-1069501632),f=c(f,m,d,g,t[n+11],14,643717713),g=c(g,f,m,d,t[n],20,-373897302),d=c(d,g,f,m,t[n+5],5,-701558691),m=c(m,d,g,f,t[n+10],9,38016083),f=c(f,m,d,g,t[n+15],14,-660478335),g=c(g,f,m,d,t[n+4],20,-405537848),d=c(d,g,f,m,t[n+9],5,568446438),m=c(m,d,g,f,t[n+14],9,-1019803690),f=c(f,m,d,g,t[n+3],14,-187363961),g=c(g,f,m,d,t[n+8],20,1163531501),d=c(d,g,f,m,t[n+13],5,-1444681467),m=c(m,d,g,f,t[n+2],9,-51403784),f=c(f,m,d,g,t[n+7],14,1735328473),d=u(d,g=c(g,f,m,d,t[n+12],20,-1926607734),f,m,t[n+5],4,-378558),m=u(m,d,g,f,t[n+8],11,-2022574463),f=u(f,m,d,g,t[n+11],16,1839030562),g=u(g,f,m,d,t[n+14],23,-35309556),d=u(d,g,f,m,t[n+1],4,-1530992060),m=u(m,d,g,f,t[n+4],11,1272893353),f=u(f,m,d,g,t[n+7],16,-155497632),g=u(g,f,m,d,t[n+10],23,-1094730640),d=u(d,g,f,m,t[n+13],4,681279174),m=u(m,d,g,f,t[n],11,-358537222),f=u(f,m,d,g,t[n+3],16,-722521979),g=u(g,f,m,d,t[n+6],23,76029189),d=u(d,g,f,m,t[n+9],4,-640364487),m=u(m,d,g,f,t[n+12],11,-421815835),f=u(f,m,d,g,t[n+15],16,530742520),d=h(d,g=u(g,f,m,d,t[n+2],23,-995338651),f,m,t[n],6,-198630844),m=h(m,d,g,f,t[n+7],10,1126891415),f=h(f,m,d,g,t[n+14],15,-1416354905),g=h(g,f,m,d,t[n+5],21,-57434055),d=h(d,g,f,m,t[n+12],6,1700485571),m=h(m,d,g,f,t[n+3],10,-1894986606),f=h(f,m,d,g,t[n+10],15,-1051523),g=h(g,f,m,d,t[n+1],21,-2054922799),d=h(d,g,f,m,t[n+8],6,1873313359),m=h(m,d,g,f,t[n+15],10,-30611744),f=h(f,m,d,g,t[n+6],15,-1560198380),g=h(g,f,m,d,t[n+13],21,1309151649),d=h(d,g,f,m,t[n+4],6,-145523070),m=h(m,d,g,f,t[n+11],10,-1120210379),f=h(f,m,d,g,t[n+2],15,718787259),g=h(g,f,m,d,t[n+9],21,-343485551),d=r(d,i),g=r(g,s),f=r(f,o),m=r(m,l);return[d,g,f,m]}function d(t){var e,n="",i=32*t.length;for(e=0;e<i;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function g(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function f(t){var e,n,i="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return i}function m(t){return unescape(encodeURIComponent(t))}function p(t){return function(t){return d(l(g(t),8*t.length))}(m(t))}function w(t,e){return function(t,e){var n,i,s=g(t),r=[],o=[];for(r[15]=o[15]=void 0,s.length>16&&(s=l(s,8*t.length)),n=0;n<16;n+=1)r[n]=909522486^s[n],o[n]=1549556828^s[n];return i=l(r.concat(g(e)),512+8*e.length),d(l(o.concat(i),640))}(m(t),m(e))}function v(t,e,n){return e?n?w(e,t):f(w(e,t)):n?p(t):f(p(t))}void 0===(i=function(){return v}.call(e,n,e,t))||(t.exports=i)}()},memg:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Location="location",t.Geo="geo",t.OS="os",t.Platform="platform",t.Browser="browser",t.Language="language",t.DisplayWidth="displayWidth",t.DisplayHeight="displayHeight",t.Source="source",t.Referrer="referrer",t.PageNumber="pageNumber",t.SessionNumber="sessionNumber",t.IsReturning="isReturning",t.Utm="utm",t.Api="api",t.Cookie="cookie",t.CssSelector="cssSelector",t.Ip="ip",t.AtOnce="atonce",t.ExitAttempted="exitAttempted",t.ScrollPercent="scrollPercent",t.TimeOnPage="timeOnPage",t.TimeOnSite="timeOnSite",t.TimeIdle="timeIdle",t.TimeSinceLastAction="timeSinceLastAction",t.ActionCount="actionCount",t.TimeSinceLastClose="timeSinceLastClose",t.CloseCount="closeCount",t.TimeSinceLastShow="timeSinceLastShow",t.ShowCount="showCount",t.Date="date",t.Time="time",t.Weekday="weekday"}(e.TargetingFilterType||(e.TargetingFilterType={}))},nYho:function(t,e,n){(function(t){var i;!function(s){e&&e.nodeType,t&&t.nodeType;var r="object"==typeof global&&global;r.global!==r&&r.window!==r&&r.self;var o,a=2147483647,c=36,u=1,h=26,l=38,d=700,g=72,f=128,m="-",p=/^xn--/,w=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=c-u,S=Math.floor,x=String.fromCharCode;function T(t){throw new RangeError(y[t])}function _(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function E(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+_((t=t.replace(v,".")).split("."),e).join(".")}function O(t){for(var e,n,i=[],s=0,r=t.length;s<r;)(e=t.charCodeAt(s++))>=55296&&e<=56319&&s<r?56320==(64512&(n=t.charCodeAt(s++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),s--):i.push(e);return i}function k(t){return _(t,function(t){var e="";return t>65535&&(e+=x((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+x(t)}).join("")}function I(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function C(t,e,n){var i=0;for(t=n?S(t/d):t>>1,t+=S(t/e);t>b*h>>1;i+=c)t=S(t/b);return S(i+(b+1)*t/(t+l))}function A(t){var e,n,i,s,r,o,l,d,p,w,v,y=[],b=t.length,x=0,_=f,E=g;for((n=t.lastIndexOf(m))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&T("not-basic"),y.push(t.charCodeAt(i));for(s=n>0?n+1:0;s<b;){for(r=x,o=1,l=c;s>=b&&T("invalid-input"),((d=(v=t.charCodeAt(s++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:c)>=c||d>S((a-x)/o))&&T("overflow"),x+=d*o,!(d<(p=l<=E?u:l>=E+h?h:l-E));l+=c)o>S(a/(w=c-p))&&T("overflow"),o*=w;E=C(x-r,e=y.length+1,0==r),S(x/e)>a-_&&T("overflow"),_+=S(x/e),x%=e,y.splice(x++,0,_)}return k(y)}function $(t){var e,n,i,s,r,o,l,d,p,w,v,y,b,_,E,k=[];for(y=(t=O(t)).length,e=f,n=0,r=g,o=0;o<y;++o)(v=t[o])<128&&k.push(x(v));for(i=s=k.length,s&&k.push(m);i<y;){for(l=a,o=0;o<y;++o)(v=t[o])>=e&&v<l&&(l=v);for(l-e>S((a-n)/(b=i+1))&&T("overflow"),n+=(l-e)*b,e=l,o=0;o<y;++o)if((v=t[o])<e&&++n>a&&T("overflow"),v==e){for(d=n,p=c;!(d<(w=p<=r?u:p>=r+h?h:p-r));p+=c)E=d-w,_=c-w,k.push(x(I(w+E%_,0))),d=S(E/_);k.push(x(I(d,0))),r=C(n,b,i==s),n=0,++i}++n,++e}return k.join("")}o={version:"1.4.1",ucs2:{decode:O,encode:k},decode:A,encode:$,toASCII:function(t){return E(t,function(t){return w.test(t)?"xn--"+$(t):t})},toUnicode:function(t){return E(t,function(t){return p.test(t)?A(t.slice(4).toLowerCase()):t})}},void 0===(i=function(){return o}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n("YuTi")(t))},oqNQ:function(t,e,n){n.r(e);var i=n("Yqmp"),s=n("Him1"),r=n("BRWp");class o{constructor(t){this.type=t,this.value=null}isHandlers(){return"callback"==this.type}isData(){return"params"==this.type||"settings"==this.type}isMethod(){return"show"==this.type||"close"==this.type||"hide"==this.type||"trackPage"==this.type}static parse(t){if(Array.isArray(t)){if((t=this.transformOnEvent(t)).length<2)throw new Error("invalid arg array length");const e=new o(t[0]);if(e.isData())if("object"==typeof t[1])e.value=Object.assign({},t[1]);else{if(!(t.length>=3))throw new Error("invalid arg array");e.value={[t[1]]:t[2]}}else if(e.isHandlers()){if(t.length<3)throw new Error("invalid handler arg");if("string"!=typeof t[1])throw new Error("arg handler type invalid");if("function"!=typeof t[2])throw new Error("arg not a function");e.value=t[1],e.callback=t[2]}else{if(!e.isMethod())throw new Error("unknown arg type "+e.type);e.value=t[1]}return e}throw new Error("unknown arg format")}static transformOnEvent(t){if(2===t.length&&"string"==typeof t[0])for(const e in r.b)if(t[0]===`on${Object(s.a)(r.b[e])}`)return["callback",r.b[e],t[1]];return t}}class a{constructor(){this.settings={},this.params={},this.callbacks={}}addNew(t){const e=o.parse(t);if(e.isData())Object.assign(this.getCollection(e.type),e.value);else if(e.isHandlers()){const t=this.getCollection(e.type),n=t[e.value]=t[e.value]||[];-1==n.indexOf(e.callback)&&n.push(e.callback)}return e}getCollection(t){if("settings"==t)return this.settings;if("params"==t)return this.params;if("callback"==t)return this.callbacks;throw new Error("unknown type")}getParams(t){const e={};for(const n in this.params||{})(void 0===t||!0===t&&!n.startsWith("_")||!1===t&&n.startsWith("_"))&&(e[n]=this.params[n]);return e}runCallbacks(t,...e){(this.callbacks[t]||[]).forEach(t=>t(...e))}}function c(t=""){let e;const n=/\+/g,i=/([^&=]+)=?([^&]*)/g,s=t=>decodeURIComponent(t.replace(n," "));t=t.replace(/^\?/g,"");const r={};for(;e=i.exec(t);)e[1]&&(r[s(e[1])]=e[2]?s(e[2]):"");return r}const u="ab";var h=n("nYho"),l="|",d=864e5;function g(t){return new Date(t.getTime()-d)}function f(t,e){for(var n=new Date(t.getTime()),i=0,s=n.getTime(),r=n.getTimezoneOffset(),o=e.untils[i];o&&o-60*(e.offsets[i]-r)*1e3<s;)o=e.untils[i++];return n.setMinutes(n.getMinutes()+e.offsets[i]-r),n}function m(t,e){var n=/^(\d{2}):(\d{2})$/i.exec(t);if(n){var i=new Date(e);return i.setHours(parseInt(n[1])),i.setMinutes(parseInt(n[2])),i.setSeconds(0),i.setMilliseconds(0),i}throw new Error("malformed time "+t)}function p(t,e){var n=t.split(l),i=n[0],s=n[1],r=n[2];return void 0===r&&(r=""),{from:i?m(i,e):void 0,to:s?m(s,e):void 0,timezone:r}}function w(t){var e=JSON.stringify,n={};return function(){var i=e(arguments);return i in n?n[i]:n[i]=t.apply(this,arguments)}}function v(t){return"string"==typeof t}function y(t){return"number"==typeof t&&!isNaN(t)}function b(t){return y(t)||"string"==typeof t&&parseFloat(t).toString()===t}var S=w(function(t,e){var n=/^\/(.+)\/([im]+)?$/.exec(t);if(n)return new RegExp(n[1],n[2]||e);var i=t.replace(/[\-\[\]\/{}()?.\\^$|]/g,"\\$&").replace(/\*/g,".*?").replace(/\+/g,".+?");return new RegExp("^"+i+"$",e)});function x(t){return!(!t||!t.exec)}var T="(0?[\\d\\*]+|0x[a-f0-9]+)",_=new RegExp("^"+T+"\\."+T+"\\."+T+"\\."+T+"$","i"),E="(?:[0-9a-f\\*]+::?)+",O={native:new RegExp("^(::)?("+E+")?([0-9a-f\\*]+)?(::)?$","i"),transitional:new RegExp("^((?:"+E+")|(?:::)(?:"+E+")?)"+T+"\\."+T+"\\."+T+"\\."+T+"$","i")},k=function(t){if(this.octets=[],this.cidr=NaN,this.version=NaN,this.maxcidr=NaN,this.masked=!1,this.octets=[],this.cidr=NaN,this.version=NaN,this.maxcidr=NaN,this.masked=!1,!t)throw new Error("no addr");if(t.match(/\//)){var e=t.split("/");t=e[0],this.cidr=parseInt(e[1])}if(t.match(/:/)){if(this.version=6,this.maxcidr=128,this.octets=function(t){if(t.match(O.native))return function(t,e){if(t.indexOf("::")!==t.lastIndexOf("::"))return null;for(var n=0,i=-1;(i=t.indexOf(":",i+1))>=0;)n++;":"===t[0]&&n--,":"===t[t.length-1]&&n--;for(var s=8-n,r=":";s--;)r+="0:";return":"===(t=t.replace("::",r))[0]&&(t=t.slice(1)),":"===t[t.length-1]&&(t=t.slice(0,-1)),t.split(":").map(function(t){return/\*/.test(t)?new RegExp("^"+t.replace(/\*/g,".*")+"$","i"):parseInt(t,16)})}(t)}(t),!this.octets)throw new Error("parse error");if(this.cidr>this.maxcidr)throw new Error("max cidr");for(var n=0,i=this.octets;n<i.length;n+=1){var s=i[n];if(!(0<=s&&s<=65535||x(s)))throw new Error("ipv6 part should fit to two octets")}}else if(t.length>=7){if(this.version=4,this.maxcidr=32,this.octets=function(t){var e=t.match(_);if(e)return e.slice(1,6).map(function(t){return/\*/.test(e=t)?new RegExp("^"+e.replace(/\*/g,".*")+"$","i"):"0"===e[0]&&"x"!==e[1]?parseInt(e,8):parseInt(e);var e})}(t),!this.octets)throw new Error("parse error");for(var r=0,o=this.octets;r<o.length;r+=1){var a=o[r];if(!(0<=a&&a<=255||x(a)))throw new Error("ipv4 octet is a byte")}if(this.cidr>this.maxcidr)throw new Error("max cidr")}if(!this.octets||isNaN(this.version))throw new Error("parse error");for(var c=0,u=this.octets;c<u.length;c+=1)if(x(u[c])){this.masked=!0;break}if(!isNaN(this.cidr)&&this.masked)throw new Error("cidr and masked")};k.prototype.match=function(t){if(t.version!==this.version||t.masked||!isNaN(t.cidr)||this.octets.length!==t.octets.length)return!1;var e=!0;if(this.masked||!this.cidr)for(var n=0;n<this.octets.length;n++){var i=this.octets[n],s=t.octets[n];e&&(e=x(i)&&y(s)?i.test(6===t.version?s.toString(16):s.toString()):i===t.octets[n])}else e=function(t,e,n,i){for(var s=0;i>0;){var r=n-i;if(r<0&&(r=0),t[s]>>r!=e[s]>>r)return!1;i-=n,s+=1}return!0}(this.octets,t.octets,6===this.version?16:8,this.cidr);return e};var I=/^((https?:)?\/\/)?([^\/?#]+)?(\/[^?#]*)?(\?[^#]*)?(#.*)?$/i,C=Object.keys;function A(t){return t.replace(/^#/,"/")}function $(t,e){var n=function(t){var e=t.match(I),n=e[2];void 0===n&&(n="http");var i=e[3];void 0===i&&(i="*");var s=e[4];void 0===s&&(s="");var r=e[5];void 0===r&&(r="");var o=e[6];void 0===o&&(o="");var a,c={href:e[0],hostname:i,search:r,hash:o,protocol:n+"//",pathname:(a=s,"/"+a.replace(/^\/+/,"").replace(/\/$/,""))};return c.href=c.protocol+c.hostname+c.pathname+c.search+c.hash,c}(t);return e.reduce(function(t,e){switch(e){case"hostname":t.hostname=Object(h.toUnicode)(n.hostname);break;case"pathname":t.pathname=decodeURIComponent(n.pathname);break;default:t[e]=n[e]}return t},{})}function P(t){return decodeURIComponent(t.replace(/\+/g," "))}function W(t){var e,n={},i=/([^&=]+)=?([^&]*)/g;for(t=t.replace(/^\?/g,"");e=i.exec(t);)n[P(e[1])]=P(e[2]);return n}var j=w(function t(e,n,i){void 0===i&&(i=["hostname","pathname","search","hash"]);var s=$(e,i),r=$(n,i),o=C(r);return o.filter(function(e){var n=r[e],i=s[e];if(n===i)return!0;if("search"===e){var o=W(i),a=C(o),c=W(n);return C(c).every(function(t){for(var e=S(c[t],""),n=S(t,""),i=!1,s=0,r=a;s<r.length;s+=1){var u=r[s];if(n.test(u)&&(i=!0,!e.test(o[u])))return!1}return i})}if("hash"===e)return t(A(i),A(n),["hostname","pathname","search"]);if("pathname"===e){var u=S(n,"i");return u.test(i)||u.test(i+"/")}return S(n,"i").test(i)}).length===o.length});function D(t,e,n,i){var s=t(e,n,i);return Array.isArray(s)?[!s[0],s[1]]:!s}function N(t,e,n){return b(e)&&b(t)?n(parseFloat(e),parseFloat(t)):null!=e&&null!=t&&n(e.toString(),t.toString())}var U={};function F(t,e){var n=e.name,i=t[e.type];return"function"==typeof i?i=i(n):null!=i&&"object"==typeof i&&n&&(i=i[n]),i}function L(t,e,n){return U[e.operation](e.value,t,n)}function R(t){return t.hasOwnProperty("items")}U["*"]=function(t,e){return!this[void 0](t,e)},U[void 0]=function(t,e){return null==e},U["="]=function(t,e){return e==t},U["!="]=function(t,e){return!this["="](t,e)},U.in=function(t,e){return v(t)&&v(e)&&-1!==e.indexOf(t)},U["!in"]=function(t,e){return!this.in(t,e)},U.match=function(t,e){return v(t)&&v(e)&&S(t).test(e)},U["!match"]=function(t,e){return!this.match(t,e)},U.$=function(t,e){return v(t)&&v(e)&&e.substring(e.length-t.length)===t},U["^"]=function(t,e){return v(t)&&v(e)&&0===e.indexOf(t)},U["!^"]=function(t,e){return D(this["^"],t,e)},U["<"]=function(t,e){return N(t,e,function(t,e){return t<e})},U["<="]=function(t,e){return N(t,e,function(t,e){return t<=e})},U[">"]=function(t,e){return N(t,e,function(t,e){return t>e})},U[">|undefined"]=function(t,e){return this[void 0](t,e)||this[">"](t,e)},U[">="]=function(t,e){return N(t,e,function(t,e){return t>=e})},U.matchUrl=function(t,e){return v(t)&&v(e)&&j(e,t)},U["!matchUrl"]=function(t,e){return D(this.matchUrl,t,e)},U.time=function(t,e,n){return y(e)&&v(t)&&function(t,e,n){try{var i=new Date(t),s=p(e,t),r=s.from,o=s.to,a=n&&n[s.timezone||""]||{offsets:[0],untils:[0]};if(!r||!o)throw new Error("no time");var c=f(r,a),u=f(o,a);return u&&u<c&&(u=new Date(u.getTime()+d)),i<c?[i>=g(c)&&i<=g(u)]:[i>=c&&i<=u]}catch(t){return[!1,t.message]}}(e,t,n&&n.timezones)},U["!time"]=function(t,e,n){return D(this.time,t,e,n)},U.matchIp=function(t,e){return v(t)&&v(e)&&function(t,e){try{var n=new k(e),i=new k(t);return[n.match(i)]}catch(t){return[!1,t.message]}}(e,t)},U["!matchIp"]=function(t,e){return D(this.matchIp,t,e)},U.date=function(t,e){return y(e)&&v(t)&&function(t,e){try{var n=new Date(t),i=function(t){var n=e.split(l),i=n[0],s=n[1];return{from:i?new Date(i):void 0,to:s?new Date(s):void 0}}(),s=i.from,r=i.to;if(!s&&!r)throw new Error("no dates");var o=new Date(s||n),a=(c=new Date(r||n),new Date(c.getTime()+d-1));return[o<=n&&n<=a]}catch(t){return[!1,t.message]}var c}(e,t)},U["!date"]=function(t,e){return D(this.date,t,e)},U.ina=function(t,e){return(y(e)||v(e))&&(n=t)&&Array.isArray(n)&&t.some(function(t){return t===e});var n},U["!ina"]=function(t,e){return D(this.ina,t,e)};var V={};function M(t){return t.hasOwnProperty("result")}V.and=function(t,e){return t&&e},V.or=function(t,e){return t||e};var H=n("memg"),z=n("SKuX");function q(t){for(const e of document.cookie.split(";")){const[n,i]=e.split("=").map(t=>t.trim());if(n==t)return decodeURIComponent(i)}}function B(t){const e=document.querySelector(t);if(e)return(e.innerText||"").trim()}let Y;var K=function(){return Y||(Y=function(){let t=!1;try{const n=Object.defineProperty({},"passive",{get(){t=!0}});window.addEventListener("test",null,n)}catch(e){}return{events:{passiveSupported:t}}}())};const Q={sensitivity:20,startCapturingAfter:1e3},G=[H.TargetingFilterType.CssSelector,H.TargetingFilterType.Cookie],J=[H.TargetingFilterType.ScrollPercent,H.TargetingFilterType.TimeOnPage,H.TargetingFilterType.TimeOnSite,H.TargetingFilterType.TimeIdle,...G],X=[H.TargetingFilterType.ExitAttempted,...J],Z={timerEnabled:!1,timerResolution:1e3,timerChangeAnyway:!1,runBounce:!1,runActivity:!1,runScroll:!1},tt={exitAttempted:!1,lastActivity:new Date,scrollPercent:0};class et extends i.a{constructor(t,e){super(),this.options=Object.assign({},Z),this.enabledKeys={},this.watches=tt,this.prevValue=null,this.configure(e),this.reset(t),this.options.runBounce&&function(t,e=document.documentElement,n=Q){const i=e=>{e.clientY<n.sensitivity&&t()},s=e=>{(e.metaKey||e.ctrlKey)&&76===e.keyCode&&t()},r=!K().events.passiveSupported||{passive:!0,capture:!0};setTimeout(()=>{e.addEventListener("mouseout",i,r),e.addEventListener("keydown",s,r)},n.startCapturingAfter)}(()=>{this.watches.exitAttempted=!0,this.update()}),this.options.runScroll&&function(t){const e=document.documentElement,n=()=>{const n=Math.max(document.body.scrollHeight,document.body.offsetHeight,e.scrollHeight,e.offsetHeight,e.clientHeight),i=((window.pageYOffset||e.scrollTop)+(window.innerHeight||e.clientHeight))/n*100;t(Math.round(i))};window.addEventListener("scroll",n,!K().events.passiveSupported||{passive:!0,capture:!1}),window.addEventListener("onload",()=>n())}(t=>{this.watches.scrollPercent=t}),this.options.runActivity&&function(t){const e=()=>t(),n=()=>t(),i=()=>t(),s=()=>t(),r=!K().events.passiveSupported||{passive:!0,capture:!0};setTimeout(()=>{window.addEventListener("click",e,r),window.addEventListener("mousemove",e,r),window.addEventListener("mouseenter",e,r),window.addEventListener("mousewheel",e,r),window.addEventListener("keydown",n,r),window.addEventListener("scroll",i,r),window.addEventListener("touchmove",s,r),window.addEventListener("touchstart",s,r)},100)}(t=>{this.watches.lastActivity=new Date}),this.options.timerEnabled&&setInterval(()=>this.update(),this.options.timerResolution)}configure(t){t.forEach(t=>{-1!==X.indexOf(t)&&(this.enabledKeys[t]=!0,-1!==J.indexOf(t)&&(this.options.timerEnabled=!0,-1!==G.indexOf(t)&&(this.options.timerChangeAnyway=!0)),t===H.TargetingFilterType.TimeIdle?this.options.runActivity=!0:t===H.TargetingFilterType.ScrollPercent?this.options.runScroll=!0:t===H.TargetingFilterType.ExitAttempted&&(this.options.runBounce=!0))})}update(){const t=this.currentValue;(this.options.timerChangeAnyway||!this.prevValue||Object.keys(this.enabledKeys).some(e=>this.prevValue[e]!==t[e]))&&(this.prevValue=t,this.trigger("change",t))}reset(t){this.visit=t,this.watches=Object.assign({},tt,{scrollPercent:this.watches.scrollPercent})}get currentValue(){const t=Date.now(),e={};return Object.keys(this.enabledKeys).forEach(n=>{n===H.TargetingFilterType.ExitAttempted?e[n]=this.watches.exitAttempted:n===H.TargetingFilterType.ScrollPercent?e[n]=this.watches.scrollPercent:n===H.TargetingFilterType.TimeIdle?e[n]=t-this.watches.lastActivity.getTime():n===H.TargetingFilterType.TimeOnPage?e[n]=t-this.visit.time:n===H.TargetingFilterType.TimeOnSite&&(e[n]=t-this.visit.sessionStartTime)}),e}}const nt=[H.TargetingFilterType.AtOnce,H.TargetingFilterType.ScrollPercent,H.TargetingFilterType.ExitAttempted,H.TargetingFilterType.TimeOnPage,H.TargetingFilterType.TimeOnSite,H.TargetingFilterType.TimeIdle];function it(t){return Object(z.a)(t.map(t=>R(t)?it(t.items):t.type))}class st extends i.a{constructor(t){super(),this.runtime=t,this.watchers=null,this.targetingKeys=null,this.reset()}async getEnvironmentForRuntime(t){const e=this.runtime.session.currentVisit,n=e.utm,i=await this.runtime.session.getServerData();return{location:e.location,source:e.source,referrer:e.referrer,pageNumber:e.pageNumber,sessionNumber:e.sessionNumber,isReturning:e.sessionNumber>1,utm:{term:n.utm_term,source:n.utm_source,content:n.utm_content,campaign:n.utm_campaign,medium:n.utm_medium},geo:i.geo.geopath,platform:i.ua.platform,os:i.ua.os,browser:i.ua.browser,language:e.language,displayWidth:e.displayWidth,displayHeight:e.displayHeight,api:this.runtime.args.getParams(),ip:i.geo.ip,cookie:q,cssSelector:B,atonce:!0,exitAttempted:void 0,scrollPercent:void 0,timeOnPage:void 0,timeOnSite:void 0,timeIdle:void 0,date:t.getTime(),time:t.getTime(),weekday:t.getDay()}}getEnvironmentForWidget(t,e){const n=this.runtime.storages.loadAllFor(t.id)||{},i=n[r.b.Show]||{time:0,value:0},s=n[r.b.Close]||{time:0,value:0},o=n[r.b.SubmitWidget]||{time:0,value:0},a=n[r.b.OpenUrl]||{time:0,value:0},c=n[r.b.ShowWidget]||{time:0,value:0},u=[o.time,a.time,c.time].filter(t=>!!t);return{timeSinceLastAction:u.length?e.getTime()-Math.max(...u):void 0,actionCount:o.value+a.value+c.value,timeSinceLastClose:s.time?e.getTime()-s.time:void 0,closeCount:s.value,timeSinceLastShow:i.time?e.getTime()-i.time:void 0,showCount:i.value}}initialize(t){this.targetingKeys=function(t){return Object(z.d)(Object(z.a)(t.map(({targeting:t})=>{if(t&&t.group)return Object(z.a)(it(t.group.items))})).filter(Boolean))}(t),this.watchers=new et(this.runtime.session.currentVisit,this.targetingKeys),this.watchers.on("change",(t,e)=>{this.trigger("change")})}async filter(t){const e=new Date,n=Object.assign({},await this.getEnvironmentForRuntime(e),this.watchers.currentValue);return t.filter(t=>{const{targeting:i}=t;if(!i||!i.group||!i.group.items.length)return!1;if(!it(i.group.items).some(t=>-1!==nt.indexOf(t)))return!1;const s=Object.assign({},n,this.getEnvironmentForWidget(t,e)),r=this.targetingResults[t.id],[o,a]=function(t){var e=t.group,n=t.data;return void 0===n&&(n={timezones:{}}),function(t,i){return function t(e,n,i,s){var r=e.id;void 0===r&&(r="");for(var o=e.items,a=e.operation,c=s+">"+r,u={id:r,operation:a,items:[]},h=0===o.length||"and"===a,l=V[a],d=0,g=o;d<g.length;d+=1){var f=g[d];if(R(f)){var m=t(f,n,i,c),p=m[1];h=l(h,m[0]),u.items.push(p)}else{var w=F(n,f),v=void 0;if(M(f)&&w===f.envValue)v=f.result,u.items.push(f);else{v=L(w,f,i);var y=void 0;Array.isArray(v)&&(y=v[1],v=v[0]),u.items.push(Object.assign({},f,{envValue:w,result:v,path:c,message:y}))}h=l(h,v)}}return[h,u]}(i||e,t,n,"")}}(i)(s,r);return this.targetingResults[t.id]=a,o})}reset(){this.targetingResults={},this.watchers&&this.watchers.reset(this.runtime.session.currentVisit)}}class rt{constructor(t){this.runtime=t,this._loadFlag=!1,this.resolver=new Promise((t,e)=>{this._loaderResolver=t,this._loaderRejecter=e})}async load(t){return this._loadFlag||(this._loadFlag=!0,t.then(t=>{const e=t.default(this.runtime);this._loaderResolver(e)}).catch(t=>{this._loaderRejecter()})),this.resolver}}class ot extends i.a{constructor(t){super(),this.runtime=t,this._created={},this.factory=null,this.loader=null,this.targeting=null,this.widgets=null,this.loader=new rt(t),this.targeting=new st(t),this.targeting.on("change",async()=>{await this.update()})}async update(t){if(t){if(this.widgets)throw new Error("already initialized");this.widgets=t.sort((t,e)=>(e.sort_order||0)-(t.sort_order||0)),this.targeting.initialize(this.widgets)}if(null==this.widgets)throw new Error("not initialized");if(0!==this.widgets.length){t=await this.filter(this.widgets);for(const e in this._created){const n=this._created[e].settings;t.some(t=>t.id==n.id)||this._destroyWidget(n)}t.forEach(t=>this._createWidget(t))}}async filter(t){const e=function(t,e){let n;const i=e.storages.load(u)||{},s=[],r={};for(n of t)if(n.groupId){let t=r[n.groupId];t?t.push(n):t=[n],r[n.groupId]=t}else s.push(n);for(const o of Object.keys(r||{})){let t;const e=r[o];if(e){if(i[o]){for(let s=0;s<e.length;s++)if((n=e[s]).id===i[o]){t=s;break}}else t=i[o]||Math.floor(Math.random()*e.length);const r=e.splice(t,1)[0];i[o]=r.id,s.push(r)}}return e.storages.save(u,i),s}(t,this.runtime).map(t=>t.id),n=await this.targeting.filter(t).then(t=>t.map(t=>t.id));return t.filter(t=>{const i=this.getWidgetUserAction(t.id);return void 0!==i?!0===i:!!this.isWidgetShownOnPage(t.id)||-1!==e.indexOf(t.id)&&-1!==n.indexOf(t.id)})}async showWidgetUser(t){const e=this.widgets.find(e=>e.id==t);if(e){const n=await this._createWidget(e);return n&&this.widgetShownByUser(t),n}return!1}async closeWidgetUser(t){const e=this.widgets.find(e=>e.id==t);if(e){const n=await this._destroyWidget(e);return n&&(this.runtime.track.add(new r.a(r.b.Close,e)),this.widgetClosedByUser(t)),n}return!1}async hideWidget(t){const e=this.widgets.find(e=>e.id==t);if(e){const t=await this._destroyWidget(e);return t&&this.runtime.track.add(new r.a(r.b.Hide,e)),t}return!1}updateWidgetTags(t){this.factory&&this.factory.updateContext(t)}async _destroyWidget(t){const e=this._created[t.id];return!(!e||!e.shown||(e.close(),delete this._created[t.id],0))}async _createWidget(t){return this.factory||(this.factory=await this.loader.load(n.e(1).then(n.bind(null,"Y1Z4")))),!this._created[t.id]&&(this._created[t.id]={settings:t,shown:!1},this._created[t.id]=await this.factory.createWidget(t),this.setWidgetShownOnPage(t.id),this.runtime.track.add(new r.a(r.b.Show,t)),!0)}widgetClosedByUser(t){this.runtime.storages.static.set(`byUser.${t}`,!1)}widgetShownByUser(t){this.runtime.storages.static.set(`byUser.${t}`,!0)}getWidgetUserAction(t){return this.runtime.storages.static.get(`byUser.${t}`)}setWidgetShownOnPage(t){this.runtime.storages.page.set(`onPage.${t}`,!0)}isWidgetShownOnPage(t){return!!this.runtime.storages.page.get(`onPage.${t}`)}async pageView(){this.targeting.reset(),this.updateContext()}async updateContext(){const t=new Date,e=await this.runtime.session.getServerData(),n=await this.loader.resolver,i=navigator.language,s=this.runtime.session.currentVisit,r=c(this.runtime.location().search),o={$date:t.toLocaleDateString(i),$month:t.toLocaleString(i,{month:"long"}),$weekday:t.toLocaleString(i,{weekday:"long"}),$day:t.toLocaleString(i,{day:"numeric"}),$country:e.geo.country,$country_code:e.geo.country_code,$region:e.geo.region,$state:e.geo.region,$state_code:e.geo.state_code,$city:e.geo.city,$postal_code:e.geo.postal_code,$browser:e.ua.browser,$device:e.ua.device,$os:e.ua.os,$platform:e.ua.platform,$utm_medium:s.utm.utm_medium,$utm_source:s.utm.utm_source,$utm_campaign:s.utm.utm_campaign,$utm_content:s.utm.utm_content,$utm_term:s.utm.utm_term};for(const a in r)o["$"+a]=r[a];n.updateContext(o)}}var at=n("8drd");function ct(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}class ut{constructor(t){this.storages=t}isInitialized(){return!!this.sessionId}loadOrCreate(t){const e=this.storages.loadSession("lastVisit"),n=(new Date).getTime();e&&e<n-60*t*1e3&&this.storages.cleanupSession();const i={newUser:!1,newSession:!1};return this.userId=this.storages.load("uid"),i.newUser=!this.userId,i.newUser&&(this.userId=ct(),this.storages.save("uid",this.userId),this.storages.cleanupSession()),this.sessionId=this.storages.loadSession("id"),i.newSession=!this.sessionId,i.newSession?(this.sessionId=ct(),this.sessionStartTime=new Date,this.storages.newSession(this.sessionId,this.sessionStartTime),this.storages.saveSession("source",window.document.referrer),this.storages.save("sessionsCount",(this.storages.load("sessionsCount")||0)+1)):this.sessionStartTime=new Date(this.storages.session.get("$start")),i}updateServerData(t){if(!this._sessionDataAwaiter){const e=this.storages.loadSession("server");this._sessionDataAwaiter=e?Promise.resolve(e):fetch(t+`?sid=${this.sessionId}`).then(t=>{if(t.ok)return t.json().then(t=>(t.timedelta=t.time-(new Date).getTime(),this.storages.saveSession("server",t),t))},t=>{})}}async getServerData(){return this._sessionDataAwaiter&&await this._sessionDataAwaiter||{timedelta:0,token:"-",geo:{},ua:{}}}pageView(t){const e=(new Date).getTime();let n=function(t){const e=c(t().search),n=c(t().hash.substring(1));return{utm_source:e.utm_source||n.utm_source||void 0,utm_medium:e.utm_medium||n.utm_medium||void 0,utm_term:e.utm_term||n.utm_term||void 0,utm_content:e.utm_content||n.utm_content||void 0,utm_campaign:e.utm_campaign||n.utm_campaign||void 0}}(t);if(Object.keys(n).some(t=>n[t]))this.storages.save("utm",n);else{const t=this.storages.load("utm");t&&(n=t)}const i=(this.storages.loadSession("pageNum")||0)+1;this.storages.saveSession("pageNum",i),this._visit={userId:this.userId,sessionId:this.sessionId,sessionStartTime:this.sessionStartTime.getTime(),time:e,location:t().href,referrer:window.document.referrer,pageNumber:i,sessionNumber:this.storages.load("sessionsCount")||1,lastVisit:this.storages.loadSession("lastVisit"),source:this.storages.loadSession("source"),utm:n,language:navigator.language.split("-")[0],displayWidth:window.screen.width,displayHeight:window.screen.height},this.storages.saveSession("lastVisit",this._visit.time)}get currentVisit(){return this._visit}}class ht{get(t){}set(t,e){}remove(t){}clear(){}}class lt{constructor(){this.store={}}get(t){return this.store[t]}set(t,e){this.store[t]=e}remove(t){delete this.store[t]}clear(){this.store={}}}class dt{constructor(t){this.name=t}get storage(){throw new Error("not implemented")}loadItem(){const t=this.storage.getItem(this.name);if(null===t)return{};try{return Object(at.b)().parse(t)}catch(e){}}get storageName(){return this.name}set(t,e){const n=this.loadItem();n[t]=e,this.storage.setItem(this.name,Object(at.b)().stringify(n))}get(t){return this.loadItem()[t]}remove(t){const e=this.loadItem();delete e[t],this.storage.setItem(this.name,Object(at.b)().stringify(e))}clear(){this.storage.removeItem(this.name)}}class gt extends dt{static isSupported(){return!!window.localStorage}get storage(){const t=window.localStorage;if(!t)throw new Error("LocalStorage not supported");return t}}class ft extends dt{static isSupported(){return!!window.localStorage}get storage(){const t=window.sessionStorage;if(!t)throw new Error("SessionStorage not supported");return t}}class mt{constructor(t="local",e="gsc"){this._page=new lt,this._static=new lt;let n=()=>new lt;if("local"===t)gt.isSupported()&&(n=t=>new gt(t));else if("session"===t)ft.isSupported()&&(n=t=>new ft(t));else if("memory"===t)n=()=>new lt;else{if("disable"!==t)throw new Error(`Unknown storage backend ${t}`);n=()=>new ht}this._general=n(e),this._widgets=n(e+"w"),this._session=n(e+"s")}save(t,e){this._general.set(t,e)}load(t){return this._general.get(t)}saveFor(t,e,n){const i=t.toString();let s=this._widgets.get(i);"object"==typeof s&&s||(s={}),s[e]=n,s.$last=(new Date).getTime(),this._widgets.set(i,s)}loadAllFor(t){const e=t.toString();return this._widgets.get(e)}loadFor(t,e){const n=this.loadAllFor(t);if(n)return n[e]}cleanupWidgets(t){}newSession(t,e){this._session.clear(),this._session.set("id",t),this._session.set("$start",e.getTime())}saveSession(t,e){this._session.set(t,e)}loadSession(t){return this._session.get(t)}cleanupSession(){this._session.clear()}get general(){return this._general}get widgets(){return this._widgets}get session(){return this._session}get page(){return this._page}get static(){return this._static}}const pt=[r.b.Show,r.b.Close,r.b.SubmitWidget,r.b.OpenUrl,r.b.Show];class wt{constructor(t,e=pt){if(this.enabledEvents=e,"boolean"==typeof t)this.enabled=t;else if(null!=t)throw new Error(`"${typeof t}" config not implemented`);this.track=this.track.bind(this)}isEnabled(){return!1!==this.enabled}isEnabledDefault(){return!0===this.enabled}isEventEnabled({type:t,widget:e}){return-1!==this.enabledEvents.indexOf(t)&&this.isWidgetEnabled(e)}isWidgetEnabled(t){return this.isEnabledDefault()}getQueue(){throw new Error("not implemented")}async finalize(t){}async track(t,e){if(0===(t=t.filter(t=>this.isEventEnabled(t))).length)return;const n=this.getQueue();n&&t.forEach((t,e)=>n(t)),await this.finalize(e)}}class vt extends wt{constructor(t){super(t),this.category="getsitecontrol"}isWidgetEnabled(t){const e=(t.settings||{}).trackGA;return!1!==e&&this.isEnabled()&&(this.isEnabledDefault()||!!e)}getQueue(){const t=window.GoogleAnalyticsObject||"ga",e=window[t];if(e&&"function"==typeof e){const t=["send"];if("function"==typeof e.getAll){const n=[];e.getAll().forEach(e=>{-1===n.indexOf(e.get("trackingId"))&&(n.push(e.get("trackingId")),t.push(e.get("name")+".send"))})}return n=>t.forEach(t=>e(t,this.transform(n)))}}transform(t){return{hitType:"event",eventCategory:this.category,eventAction:t.type,eventLabel:t.widget?`${t.widget.name} #${t.widget.id}`:void 0,nonInteraction:!t.isAction()}}}class yt extends wt{constructor(t){super(t),this.dataLayerName="dataLayer"}isWidgetEnabled(t){const e=(t.settings||{}).trackGTM;return!1!==e&&this.isEnabled()&&(this.isEnabledDefault()||!!e)}getQueue(){const t=window[this.dataLayerName];if(t&&"function"==typeof t.push)return e=>t.push(this.transform(e))}transform(t){const e={event:`gsc.${t.type}`,"gsc.eventData":t.prettyData()};return t.widget&&(e["gsc.widgetId"]=t.widget.id),e}}const bt=n("jYEY");class St extends wt{constructor(t,e,n){super(!!e,n),this.session=t,this.eventsUrl=e,this.events=[]}getQueue(){return t=>{const e={data:t.data,type:t.type};t.widget&&(e.widgetId=t.widget.id),this.events.push(e)}}async finalize(t){if(0==this.events.length)return;const e=Object.assign({},t,{events:this.events.slice()});this.events.length=0;const n=Object(at.b)().stringify(e);let i=!1;const s=await this.session.getServerData(),r=t.date+s.timedelta,o=`${r}:${t.sessionId}`,a=bt(n,o),c=this.eventsUrl+`?ts=${r}&sid=${t.sessionId}&t=${s.token||""}&s=${a}`;"function"==typeof window.navigator.sendBeacon&&(i=window.navigator.sendBeacon(c,n)),i||await fetch(c,{method:"POST",body:n})}}function xt(t){return async(e,n)=>{const i=(new Date).getTime();for(const s of e)if(s.widget){const e=t.storages.loadFor(s.widget.id,s.type)||{time:i,value:0};e.time=i,e.value+=1,t.storages.saveFor(s.widget.id,s.type,e)}}}const Tt={sessionLength:20,storage:"local",storagePrefix:"gsc",placement:"website",events:[r.b.Session,r.b.Show,r.b.SubmitWidget,r.b.OpenUrl,r.b.ShowWidget],trackLocation:!0};class _t extends i.a{get args(){return this._args}constructor(t={}){super(),Object(at.d)(document),this.settings=Object.assign({},Tt,t),this.location=function(){let t=window.document.location;const e=window.document.createElement("a");return(()=>{let n=0;const i=()=>t;return i.set=n=>(e.href=n,""===e.host&&(e.href=e.href),t=e,i.stopTrack(),!0),i.track=(e,i=100)=>{if(!n){let s=t.pathname+"?"+t.search;n=window.setInterval(()=>{const n=t.pathname+"?"+t.search;s!==n&&(s=n,e())},i)}},i.stopTrack=()=>{n&&(clearInterval(n),n=0)},i})()}(),this.storages=new mt(this.settings.storage,this.settings.storagePrefix),this.session=new ut(this.storages),this.display=new ot(this),this._args=new a,this.updateSettings(),this.pageView()}async updateSettings(t={}){t&&(this.settings=Object.assign({},this.settings,t)),this.initTracking(),this.settings.trackLocation?this.location.track(this.onLocationChange.bind(this)):this.location.stopTrack()}initTracking(){const t=[(e=this,(t,n)=>{for(const i of t)e.args.runCallbacks(i.type,i.widget?i.widget.id:void 0,i.prettyData(),n)}),xt(this)];var e;const n=new St(this.session,this.settings.serverUrl,this.settings.events);n.isEnabled()&&t.push(n.track);const i=new vt(this.settings.trackGA);i.isEnabled()&&t.push(i.track);const s=new yt(this.settings.trackGTM);s.isEnabled()&&t.push(s.track),this.track=new r.c(this,t)}pageView(){let t={newUser:!1,newSession:!1};this.session.isInitialized()||(t=this.session.loadOrCreate(this.settings.sessionLength)),this.session.pageView(this.location),t.newUser&&this.track.add(new r.a(r.b.User)),t.newSession&&this.track.add(new r.a(r.b.Session)),this.settings.serverUrl&&this.session.updateServerData(this.settings.serverUrl),this.display.pageView(),this.storages.page.clear(),this.track.add(new r.a(r.b.PageView))}async run(t){await this.display.update(t)}async showWidget(t){return this.display.showWidgetUser(t)}async closeWidget(t){return this.display.closeWidgetUser(t)}async apiCall(t){const e=this._args.addNew(t);let n=!1;"settings"==e.type&&this.updateSettings(e.value),"params"==e.type?(this.display.updateWidgetTags(this.args.getParams()),n=!0):"trackPage"==e.type?(this.location.set(e.value),this.pageView(),n=!0):"show"==e.type?await this.showWidget(e.value):"close"==e.type?await this.closeWidget(e.value):"hide"==e.type&&await this.display.hideWidget(e.value),n&&await this.display.update()}async onLocationChange(){this.pageView(),await this.display.update()}}let Et;const Ot=window,kt=function(){if(Et)return Et.apiCall([...arguments]);kt.q.push(arguments)};kt.q=[],kt.start=({runtime:t,widgets:e=[]}={})=>{Ot.document.documentMode||(Et||(Et=new _t(t)),Et.run(e),kt.q&&(kt.q.forEach(t=>kt(...t)),delete kt.q))};const It=Ot.gsc;if(!It||!It.start){const t=It&&It.q||[];kt.q=[...t],Ot.gsc=kt}}});
//# sourceMappingURL=runtime.3.0.b1b811e.js.map